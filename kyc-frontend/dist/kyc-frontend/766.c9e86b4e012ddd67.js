"use strict";(self.webpackChunkkyc_frontend=self.webpackChunkkyc_frontend||[]).push([[766],{7766:(D,f,o)=>{o.r(f),o.d(f,{KnowledgeBaseUploadComponent:()=>R});var e=o(4438),m=o(177),i=o(9417),d=o(5596),g=o(8834),h=o(9631),F=o(2798),v=o(7575),b=o(9213),C=o(5416),k=o(1626),y=o(5312);let U=(()=>{class t{constructor(){this.http=(0,e.WQX)(k.Qq),this.apiUrl=`${y.c.apiUrl}/rag`}ingestDocument(a,n,l,s){const r=new FormData;return r.append("file",a),r.append("category",n),r.append("title",l),r.append("version",s),this.http.post(`${this.apiUrl}/ingest`,r)}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var c=o(882),I=o(6600);function E(t,p){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Title is required "),e.k0s())}function j(t,p){if(1&t&&(e.j41(0,"mat-option",20),e.EFF(1),e.k0s()),2&t){const a=p.$implicit;e.Y8G("value",a.value),e.R7$(),e.SpI(" ",a.label," ")}}function P(t,p){1&t&&(e.j41(0,"mat-error"),e.EFF(1," Version is required "),e.k0s())}function T(t,p){if(1&t&&(e.j41(0,"span",21),e.EFF(1),e.k0s()),2&t){const a=e.XpG();e.R7$(),e.JRh(a.selectedFile.name)}}function O(t,p){1&t&&(e.j41(0,"span",22),e.EFF(1,"No file selected (PDF, TXT)"),e.k0s())}function B(t,p){1&t&&e.nrm(0,"mat-progress-bar",23)}let R=(()=>{class t{constructor(){this.fb=(0,e.WQX)(i.ok),this.kbaseService=(0,e.WQX)(U),this.snackBar=(0,e.WQX)(C.UG),this.uploadForm=this.fb.group({title:["",i.k0.required],version:["",i.k0.required],category:["REGULATION",i.k0.required],file:[null,i.k0.required]}),this.selectedFile=null,this.isUploading=(0,e.vPA)(!1),this.uploadProgress=(0,e.vPA)(0),this.categories=[{value:"REGULATION",label:"Regulation (Law)"},{value:"PROCEDURE",label:"Procedure (Internal)"},{value:"GUIDELINE",label:"Guideline (Best Practice)"},{value:"FAQ",label:"FAQ (Example Q&A)"},{value:"POLICY",label:"Policy (Governance)"}]}onFileSelected(a){const n=a.target.files[0];if(n){if("application/pdf"!==n.type&&"text/plain"!==n.type)return void this.snackBar.open("Invalid file type. Only PDF and TXT allowed.","Close",{duration:3e3});this.selectedFile=n,this.uploadForm.patchValue({file:n}),this.uploadForm.get("file")?.updateValueAndValidity()}}onSubmit(){if(this.uploadForm.valid&&this.selectedFile){this.isUploading.set(!0);const a=this.uploadForm.value;this.kbaseService.ingestDocument(this.selectedFile,a.category,a.title,a.version).subscribe({next:n=>{this.isUploading.set(!1),this.snackBar.open("Document ingested successfully!","Close",{duration:3e3}),this.uploadForm.reset({category:"REGULATION"}),this.selectedFile=null},error:n=>{this.isUploading.set(!1),this.snackBar.open("Failed to ingest document: "+(n.error?.message||n.message),"Close",{duration:5e3})}})}}static{this.\u0275fac=function(n){return new(n||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-knowledge-base-upload"]],standalone:!0,features:[e.aNF],decls:39,vars:9,consts:[["fileInput",""],[1,"upload-container"],[3,"ngSubmit","formGroup"],[1,"form-field"],["appearance","outline",1,"full-width"],["matInput","","formControlName","title","placeholder","e.g. New AML Regulation 2026"],[4,"ngIf"],[1,"form-row"],["appearance","outline",1,"half-width"],["formControlName","category"],[3,"value",4,"ngFor","ngForOf"],["matInput","","formControlName","version","placeholder","e.g. v1.0"],[1,"file-upload-area"],["type","file","accept",".pdf,.txt","hidden","",3,"change"],["type","button","mat-stroked-button","","color","primary",3,"click"],["class","file-name",4,"ngIf"],["class","file-name placeholder",4,"ngIf"],["mode","indeterminate",4,"ngIf"],[1,"actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],[3,"value"],[1,"file-name"],[1,"file-name","placeholder"],["mode","indeterminate"]],template:function(n,l){if(1&n){const s=e.RV6();e.j41(0,"div",1)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),e.EFF(4,"Upload Regulatory Document"),e.k0s(),e.j41(5,"mat-card-subtitle"),e.EFF(6,"Ingest new knowledge into the AI system"),e.k0s()(),e.j41(7,"mat-card-content")(8,"form",2),e.bIt("ngSubmit",function(){return e.eBV(s),e.Njj(l.onSubmit())}),e.j41(9,"div",3)(10,"mat-form-field",4)(11,"mat-label"),e.EFF(12,"Document Title"),e.k0s(),e.nrm(13,"input",5),e.DNE(14,E,2,0,"mat-error",6),e.k0s()(),e.j41(15,"div",7)(16,"mat-form-field",8)(17,"mat-label"),e.EFF(18,"Category"),e.k0s(),e.j41(19,"mat-select",9),e.DNE(20,j,2,2,"mat-option",10),e.k0s()(),e.j41(21,"mat-form-field",8)(22,"mat-label"),e.EFF(23,"Version"),e.k0s(),e.nrm(24,"input",11),e.DNE(25,P,2,0,"mat-error",6),e.k0s()(),e.j41(26,"div",12)(27,"input",13,0),e.bIt("change",function(u){return e.eBV(s),e.Njj(l.onFileSelected(u))}),e.k0s(),e.j41(29,"button",14),e.bIt("click",function(){e.eBV(s);const u=e.sdS(28);return e.Njj(u.click())}),e.j41(30,"mat-icon"),e.EFF(31,"cloud_upload"),e.k0s(),e.EFF(32," Select File "),e.k0s(),e.DNE(33,T,2,1,"span",15)(34,O,2,0,"span",16),e.k0s(),e.DNE(35,B,1,0,"mat-progress-bar",17),e.j41(36,"div",18)(37,"button",19),e.EFF(38),e.k0s()()()()()()}if(2&n){let s,r;e.R7$(8),e.Y8G("formGroup",l.uploadForm),e.R7$(6),e.Y8G("ngIf",null==(s=l.uploadForm.get("title"))?null:s.hasError("required")),e.R7$(6),e.Y8G("ngForOf",l.categories),e.R7$(5),e.Y8G("ngIf",null==(r=l.uploadForm.get("version"))?null:r.hasError("required")),e.R7$(8),e.Y8G("ngIf",l.selectedFile),e.R7$(),e.Y8G("ngIf",!l.selectedFile),e.R7$(),e.Y8G("ngIf",l.isUploading()),e.R7$(2),e.Y8G("disabled",!l.uploadForm.valid||!l.selectedFile||l.isUploading()),e.R7$(),e.SpI(" ",l.isUploading()?"Uploading...":"Ingest Document"," ")}},dependencies:[m.MD,m.Sq,m.bT,i.X1,i.qT,i.me,i.BC,i.cb,i.j4,i.JD,d.Hu,d.RN,d.m2,d.MM,d.Lc,d.dh,g.Hl,g.$z,h.fS,h.fg,c.rl,c.nJ,c.TL,F.Ve,F.VO,I.wT,v.PO,v.HM,b.m_,b.An,C._T],styles:[".upload-container[_ngcontent-%COMP%]{max-width:800px;margin:20px auto;padding:0 20px}mat-card[_ngcontent-%COMP%]{margin-bottom:24px}mat-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.form-field[_ngcontent-%COMP%]{margin-bottom:16px}.form-row[_ngcontent-%COMP%]{display:flex;gap:16px;margin-bottom:16px}.full-width[_ngcontent-%COMP%]{width:100%}.half-width[_ngcontent-%COMP%]{width:50%}.file-upload-area[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:24px;border:2px dashed #e0e0e0;border-radius:4px;margin-bottom:24px;background-color:#fafafa;transition:background-color .2s}.file-upload-area[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.file-name[_ngcontent-%COMP%]{font-size:14px;color:#333}.file-name.placeholder[_ngcontent-%COMP%]{color:#999;font-style:italic}.actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-top:16px}mat-progress-bar[_ngcontent-%COMP%]{margin-bottom:16px}"]})}}return t})()}}]);