"use strict";(self.webpackChunkkyc_frontend=self.webpackChunkkyc_frontend||[]).push([[469],{6469:(E,h,i)=>{i.r(h),i.d(h,{ChatbotComponent:()=>$});var g=i(177),m=i(9417),r=i(5596),f=i(8834),u=i(9213),C=i(9631),v=i(882),x=i(6471),y=i(9183),t=i(4438),M=i(1626),b=i(5312);let _=(()=>{class n{constructor(e){this.http=e,this.apiUrl=`${b.c.apiUrl}/chat`}sendMessage(e,a,s=!1,o="",l=[]){const p={message:e,hasActiveApplication:s,currentStatus:o,documentsSubmitted:l};let d=new M.Lr;return a&&(d=d.set("X-Session-Id",a)),this.http.post(`${this.apiUrl}/message`,p,{headers:d})}deleteHistory(e){return this.http.delete(`${this.apiUrl}/history/${e}`)}getHistory(e){return this.http.get(`${this.apiUrl}/history/${e}`)}static{this.\u0275fac=function(a){return new(a||n)(t.KVO(M.Qq))}}static{this.\u0275prov=t.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const F=["messageContainer"];function O(n,c){if(1&n&&(t.j41(0,"div",17),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.SpI(" ",t.i5U(2,1,e.timestamp,"shortTime")," ")}}function k(n,c){if(1&n){const e=t.RV6();t.j41(0,"mat-chip",20),t.bIt("click",function(){const s=t.eBV(e).$implicit,o=t.XpG(3);return t.Njj(o.sendMessage(s))}),t.EFF(1),t.k0s()}if(2&n){const e=c.$implicit;t.R7$(),t.SpI(" ",e," ")}}function T(n,c){if(1&n&&(t.j41(0,"div",18),t.DNE(1,k,2,1,"mat-chip",19),t.k0s()),2&n){const e=t.XpG().$implicit;t.R7$(),t.Y8G("ngForOf",e.suggestedActions)}}function P(n,c){1&n&&(t.j41(0,"div",21)(1,"mat-icon"),t.EFF(2,"support_agent"),t.k0s(),t.j41(3,"span"),t.EFF(4,"This conversation will be escalated to a human agent."),t.k0s()())}function I(n,c){if(1&n&&(t.j41(0,"div",12)(1,"div",13),t.EFF(2),t.k0s(),t.DNE(3,O,3,4,"div",14)(4,T,2,1,"div",15)(5,P,5,0,"div",16),t.k0s()),2&n){const e=c.$implicit;t.AVh("user","user"===e.role)("assistant","assistant"===e.role),t.R7$(2),t.SpI(" ",e.content," "),t.R7$(),t.Y8G("ngIf",e.timestamp),t.R7$(),t.Y8G("ngIf",e.suggestedActions&&"assistant"===e.role),t.R7$(),t.Y8G("ngIf",e.escalationNeeded)}}function j(n,c){1&n&&(t.j41(0,"div",22),t.nrm(1,"mat-spinner",23),t.j41(2,"span"),t.EFF(3,"Assistant is typing..."),t.k0s()())}let $=(()=>{class n{constructor(e){this.chatService=e,this.messages=[],this.currentMessage="",this.isTyping=!1}ngOnInit(){this.messages.push({role:"assistant",content:"Hello! I'm your KYC support assistant. How can I help you today?",timestamp:new Date})}sendMessage(e){const a=e||this.currentMessage.trim();!a||this.isTyping||(this.messages.push({role:"user",content:a,timestamp:new Date}),this.currentMessage="",this.isTyping=!0,this.scrollToBottom(),this.chatService.sendMessage(a,this.sessionId,!1,"",[]).subscribe({next:s=>{this.sessionId=s.sessionId,this.messages.push({role:"assistant",content:s.response,timestamp:new Date,suggestedActions:s.suggestedActions,escalationNeeded:s.escalationNeeded}),this.isTyping=!1,this.scrollToBottom()},error:s=>{this.messages.push({role:"assistant",content:"I apologize, but I'm having trouble responding right now. Please try again later.",timestamp:new Date}),this.isTyping=!1,this.scrollToBottom()}}))}scrollToBottom(){setTimeout(()=>{this.messageContainer&&(this.messageContainer.nativeElement.scrollTop=this.messageContainer.nativeElement.scrollHeight)},100)}static{this.\u0275fac=function(a){return new(a||n)(t.rXU(_))}}static{this.\u0275cmp=t.VBU({type:n,selectors:[["app-chatbot"]],viewQuery:function(a,s){if(1&a&&t.GBs(F,5),2&a){let o;t.mGM(o=t.lsd())&&(s.messageContainer=o.first)}},standalone:!0,features:[t.aNF],decls:26,vars:5,consts:[["messageContainer",""],[1,"chatbot-container"],[1,"chat-card"],["mat-card-avatar",""],[1,"chat-messages"],["class","message",3,"user","assistant",4,"ngFor","ngForOf"],["class","typing-indicator",4,"ngIf"],[1,"chat-input-container"],["appearance","outline",1,"message-input"],["matInput","","placeholder","Type your message...",3,"ngModelChange","keyup.enter","ngModel","disabled"],["mat-fab","","color","primary",3,"click","disabled"],[1,"chat-disclaimer"],[1,"message"],[1,"message-content"],["class","message-time",4,"ngIf"],["class","suggested-actions",4,"ngIf"],["class","escalation-warning",4,"ngIf"],[1,"message-time"],[1,"suggested-actions"],["class","action-chip",3,"click",4,"ngFor","ngForOf"],[1,"action-chip",3,"click"],[1,"escalation-warning"],[1,"typing-indicator"],["diameter","20"]],template:function(a,s){if(1&a){const o=t.RV6();t.j41(0,"div",1)(1,"mat-card",2)(2,"mat-card-header")(3,"mat-icon",3),t.EFF(4,"smart_toy"),t.k0s(),t.j41(5,"mat-card-title"),t.EFF(6,"KYC Support Assistant"),t.k0s(),t.j41(7,"mat-card-subtitle"),t.EFF(8,"Ask me anything about KYC verification"),t.k0s()(),t.j41(9,"mat-card-content")(10,"div",4,0),t.DNE(12,I,6,8,"div",5)(13,j,4,0,"div",6),t.k0s()(),t.j41(14,"mat-card-actions",7)(15,"mat-form-field",8)(16,"input",9),t.mxI("ngModelChange",function(p){return t.eBV(o),t.DH7(s.currentMessage,p)||(s.currentMessage=p),t.Njj(p)}),t.bIt("keyup.enter",function(){return t.eBV(o),t.Njj(s.sendMessage())}),t.k0s()(),t.j41(17,"button",10),t.bIt("click",function(){return t.eBV(o),t.Njj(s.sendMessage())}),t.j41(18,"mat-icon"),t.EFF(19,"send"),t.k0s()()(),t.j41(20,"mat-card-footer")(21,"div",11)(22,"mat-icon"),t.EFF(23,"info"),t.k0s(),t.j41(24,"span"),t.EFF(25,"This conversation may be monitored for quality assurance. For data deletion requests, please contact our DPO."),t.k0s()()()()()}2&a&&(t.R7$(12),t.Y8G("ngForOf",s.messages),t.R7$(),t.Y8G("ngIf",s.isTyping),t.R7$(3),t.R50("ngModel",s.currentMessage),t.Y8G("disabled",s.isTyping),t.R7$(),t.Y8G("disabled",!s.currentMessage.trim()||s.isTyping))},dependencies:[g.MD,g.Sq,g.bT,g.vh,m.YN,m.me,m.BC,m.vS,r.Hu,r.RN,r.YY,r.QG,r.m2,r.WQ,r.MM,r.Lc,r.dh,f.Hl,f.Sr,u.m_,u.An,C.fS,C.fg,v.rl,v.RG,x.YN,x.Jl,y.D6,y.LG],styles:[".chatbot-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;height:calc(100vh - 104px)}.chat-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}mat-card-content[_ngcontent-%COMP%]{flex:1;overflow:hidden;padding:0}.chat-messages[_ngcontent-%COMP%]{height:100%;overflow-y:auto;padding:20px;background:#fafafa}.message[_ngcontent-%COMP%]{margin-bottom:16px;max-width:80%;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.message.user[_ngcontent-%COMP%]{margin-left:auto;text-align:right}.message.user[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#1976d2;color:#fff;border-radius:18px 18px 4px}.message.assistant[_ngcontent-%COMP%]{margin-right:auto}.message.assistant[_ngcontent-%COMP%]   .message-content[_ngcontent-%COMP%]{background:#fff;border:1px solid #e0e0e0;border-radius:18px 18px 18px 4px}.message-content[_ngcontent-%COMP%]{display:inline-block;padding:12px 16px;font-size:14px;line-height:1.5;white-space:pre-wrap}.message-time[_ngcontent-%COMP%]{font-size:11px;color:#999;margin-top:4px}.suggested-actions[_ngcontent-%COMP%]{margin-top:8px;display:flex;flex-wrap:wrap;gap:8px}.action-chip[_ngcontent-%COMP%]{cursor:pointer;font-size:12px}.action-chip[_ngcontent-%COMP%]:hover{background:#e3f2fd}.escalation-warning[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;padding:8px 12px;background:#fff3e0;border-radius:8px;font-size:12px;color:#e65100}.escalation-warning[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:16px;width:16px;height:16px}.typing-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;color:#666;font-size:14px}.chat-input-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px;background:#fff;border-top:1px solid #e0e0e0}.message-input[_ngcontent-%COMP%]{flex:1;margin-bottom:-1.25em}.chat-disclaimer[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#f5f5f5;font-size:11px;color:#666}.chat-disclaimer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}"]})}}return n})()}}]);